<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Lawn Restoration Plan | Arlington Heights, IL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        let app, db, auth, userId;
        let isAuthReady = false;
        let nutrientChartInstance;

        function getTodayDateString() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        document.addEventListener('DOMContentLoaded', async function() {
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        isAuthReady = true;
                        document.getElementById('user-id-display').textContent = `User ID: ${userId}`;
                        fetchAndDisplayTasks();
                    } else {
                        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                        try {
                            if (initialAuthToken) {
                                await signInWithCustomToken(auth, initialAuthToken);
                            } else {
                                await signInAnonymously(auth);
                            }
                        } catch (error) {
                            console.error("Firebase Auth Error:", error);
                            userId = crypto.randomUUID();
                            isAuthReady = true;
                            document.getElementById('user-id-display').textContent = `User ID (Anon Fallback): ${userId}`;
                            fetchAndDisplayTasks();
                        }
                    }
                });
            } else {
                console.error("Firebase config not found. Running without persistence.");
                userId = crypto.randomUUID();
                isAuthReady = true;
                document.getElementById('user-id-display').textContent = `User ID (No Firebase): ${userId}`;
                fetchAndDisplayTasks();
            }

            const initialTasks = [
                { id: 'task1', name: 'Comprehensive Soil Testing', description: 'Collect 10-15 random samples (3-6 inch depth), mix, dry, and send to a certified lab. Critical for precise nutrient and pH analysis.', dueDate: '2025-07-28', category: 'Prep', completed: false },
                { id: 'task2', name: 'Weed & Pest Identification', description: 'Identify existing weeds (dandelion, clover, crabgrass) and pests (grubs). Focus on hand-pulling for small areas. Avoid broad chemical application above 85°F.', dueDate: '2025-07-29', category: 'Prep', completed: false },
                { id: 'task3', name: 'Water Deeply & Infrequently', description: 'Water lawn with 1-1.5 inches per week, preferably in one session in early morning. Encourage deep root growth.', dueDate: '2025-07-30', category: 'Prep', completed: false },
                { id: 'task4', name: 'Raise Mower Blade & Mow Properly', description: 'Set mower to 3-3.5 inches. Never remove more than one-third of the blade at a time. Keep blades sharp.', dueDate: '2025-07-31', category: 'Prep', completed: false },
                { id: 'task5', name: 'Aeration & Dethatching', description: 'Use core aerator to reduce compaction. Dethatch if thatch layer is over 0.5 inches. Do when soil is moist.', dueDate: '2025-08-20', category: 'Restore', completed: false },
                { id: 'task6', name: 'Overseeding with Quality Blend', description: 'Immediately after aeration, spread cool-season grass blend (Kentucky Bluegrass, Perennial Ryegrass, Fescue). Cover with peat moss/straw and water daily until germination (10-14 days).', dueDate: '2025-08-25', category: 'Restore', completed: false },
                { id: 'task7', name: 'Apply Starter Fertilizer', description: 'Apply a high-phosphorus starter fertilizer (e.g., 10-18-10) at time of seeding to promote strong root development.', dueDate: '2025-08-25', category: 'Restore', completed: false },
                { id: 'task8', name: 'Fall Fertilization (Sept)', description: 'Apply slow-release fertilizer in September for root development and winter hardiness.', dueDate: '2025-09-15', category: 'Maintain', completed: false },
                { id: 'task9', name: 'Spot Treat Broadleaf Weeds (Fall)', description: 'Spot-treat existing broadleaf weeds in the fall when they are actively growing and absorbing nutrients.', dueDate: '2025-09-25', category: 'Maintain', completed: false },
                { id: 'task10', name: 'Monitor & Treat for Grubs', description: 'Monitor for grub activity. Apply Dylox for immediate control or beneficial nematodes for long-term if found.', dueDate: '2025-09-01', category: 'Maintain', completed: false },
                { id: 'task11', name: 'Fall Fertilization (Nov)', description: 'Second fall feeding (Winterizer) in early November for strong roots and early spring green-up.', dueDate: '2025-11-05', category: 'Maintain', completed: false },
                { id: 'task12', name: 'Pre-Emergent Herbicide (Spring next year)', description: 'Apply in late April/early May (next year) to prevent crabgrass. Do not apply if planning to overseed.', dueDate: '2026-04-25', category: 'Maintain', completed: false },
                { id: 'task13', name: 'Spring Fertilization (Early Spring next year)', description: 'Apply slow-release fertilizer as lawn greens up (Feb-Apr next year).', dueDate: '2026-03-15', category: 'Maintain', completed: false },
                { id: 'task14', name: 'Spring Fertilization (Late Spring next year)', description: 'Second spring feeding 6-8 weeks after first (Apr-Jun next year).', dueDate: '2026-05-01', category: 'Maintain', completed: false },
                { id: 'task15', name: 'Summer Fertilization (next year)', description: 'Optional summer feeding in late June/early July if needed and with adequate water.', dueDate: '2026-07-01', category: 'Maintain', completed: false },
            ];

            async function fetchAndDisplayTasks() {
                if (!isAuthReady) {
                    return;
                }

                const tasksDocRef = doc(db, `artifacts/${appId}/users/${userId}/lawnData/tasks`);
                try {
                    const docSnap = await getDoc(tasksDocRef);
                    let currentTasks = [];
                    if (docSnap.exists() && docSnap.data().tasks) {
                        currentTasks = docSnap.data().tasks;
                    } else {
                        await setDoc(tasksDocRef, { tasks: initialTasks });
                        currentTasks = initialTasks;
                    }

                    onSnapshot(tasksDocRef, (doc) => {
                        const latestTasks = doc.data().tasks || [];
                        renderTasks(latestTasks);
                    }, (error) => {
                        console.error("Error listening to tasks:", error);
                        renderTasks(currentTasks);
                    });

                } catch (error) {
                    console.error("Error fetching or initializing tasks:", error);
                    renderTasks(initialTasks);
                }
            }

            async function updateTaskCompletion(taskId, completed) {
                if (!isAuthReady || !db || !userId || !appId) {
                    console.warn("Cannot update task: Firebase not ready or user ID missing.");
                    return;
                }
                const tasksDocRef = doc(db, `artifacts/${appId}/users/${userId}/lawnData/tasks`);
                try {
                    const docSnap = await getDoc(tasksDocRef);
                    if (docSnap.exists()) {
                        const currentTasks = docSnap.data().tasks;
                        const updatedTasks = currentTasks.map(task => {
                            if (task.id === taskId) {
                                return { ...task, completed: completed, completedDate: completed ? getTodayDateString() : '' };
                            }
                            return task;
                        });
                        await setDoc(tasksDocRef, { tasks: updatedTasks });
                    }
                } catch (error) {
                    console.error("Error updating task completion:", error);
                }
            }

            function renderTasks(tasks) {
                const todayTasksContainer = document.getElementById('today-tasks-list');
                const completedTasksContainer = document.getElementById('completed-tasks-list');
                todayTasksContainer.innerHTML = '';
                completedTasksContainer.innerHTML = '';

                const today = getTodayDateString();
                
                tasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));

                tasks.forEach(task => {
                    if (!task.completed && task.dueDate === today) {
                        const taskElement = document.createElement('div');
                        taskElement.className = 'flex items-start bg-white p-4 rounded-xl shadow-md mb-3';
                        taskElement.innerHTML = `
                            <input type="checkbox" id="task-${task.id}" class="mt-1 mr-3 h-5 w-5 text-emerald-600 focus:ring-emerald-600 border-gray-300 rounded">
                            <div class="flex-1">
                                <label for="task-${task.id}" class="text-lg font-semibold text-gray-800">${task.name}</label>
                                <p class="text-sm text-gray-600">${task.description}</p>
                                <span class="text-xs font-medium uppercase mt-1 px-2 py-1 rounded-full self-start ${getCategoryColor(task.category)}">${task.category}</span>
                                <p class="text-xs text-gray-500 mt-1">Due: ${task.dueDate}</p>
                            </div>
                        `;
                        todayTasksContainer.appendChild(taskElement);
                        taskElement.querySelector(`#task-${task.id}`).addEventListener('change', (e) => {
                            updateTaskCompletion(task.id, e.target.checked);
                        });
                    } else if (task.completed) {
                        const completedTaskElement = document.createElement('div');
                        completedTaskElement.className = 'flex items-start bg-gray-50 p-4 rounded-xl shadow-sm mb-3 line-through text-gray-500';
                        completedTaskElement.innerHTML = `
                            <input type="checkbox" id="task-${task.id}" class="mt-1 mr-3 h-5 w-5 text-emerald-600 focus:ring-emerald-600 border-gray-300 rounded" checked disabled>
                            <div class="flex-1">
                                <label for="task-${task.id}" class="text-lg font-semibold">${task.name}</label>
                                <p class="text-sm">${task.description}</p>
                                <span class="text-xs font-medium uppercase mt-1 px-2 py-1 rounded-full self-start ${getCategoryColor(task.category)}">${task.category}</span>
                                <p class="text-xs mt-1">Completed: ${task.completedDate}</p>
                            </div>
                        `;
                        completedTasksContainer.appendChild(completedTaskElement);
                    }
                });

                if (todayTasksContainer.children.length === 0) {
                    todayTasksContainer.innerHTML = '<p class="text-gray-500 text-center py-4">No tasks scheduled for today. Enjoy your robust lawn!</p>';
                }
                if (completedTasksContainer.children.length === 0) {
                    completedTasksContainer.innerHTML = '<p class="text-gray-500 text-center py-4">No tasks completed yet.</p>';
                }
            }
        });
    </script>
    <!-- Chosen Palette: Lush Modern Palette -->
    <!-- Application Structure Plan: A task-oriented, chronological single-page application. The structure guides the user from understanding their local environment to executing a seasonal plan. It starts with a 'Local Conditions' dashboard, moves to a 'Today's Focus' for daily actionable tasks, then to a 'Today's Weather & Watering Advice' section, a phased timeline ('Phase 1: Prep', 'Phase 2: Restoration', 'Phase 3: Maintenance'), followed by 'Past Tasks', a 'Soil Test Input' tool, and ending with a 'Tools & Products' checklist. This structure was chosen to make a dense report digestible and actionable, allowing users to focus on what needs to be done 'now' while still seeing the full picture and tracking progress. Interactions like tab-switching for seasons and expanding details for tasks prevent information overload, while checkboxes, a dedicated completed list, and dynamic weather/soil input enhance daily usability and personalization. -->
    <!-- Visualization & Content Choices: 
        - Local Conditions: Goal: Inform. Method: Chart.js line (temp), doughnut (soil), and bar (nutrients) charts. Interaction: Hover tooltips. Justification: Visualizes complex data for quick understanding.
        - Today's Focus: Goal: Act. Method: HTML list with checkboxes. Interaction: Click to check off tasks, which updates persistence. Justification: Provides immediate, actionable steps for the current day.
        - Today's Weather & Watering Advice: Goal: Inform/Advise. Method: HTML text display. Interaction: Dynamic text based on mocked weather. Justification: Provides real-time context for daily decisions.
        - Restoration Plan: Goal: Guide. Method: HTML/CSS vertical timeline/accordion. Interaction: Click to expand details. Justification: Breaks down the process into manageable, chronological steps.
        - Past Tasks: Goal: Track. Method: HTML list showing completed tasks. Interaction: View only. Justification: Allows users to review their progress over time.
        - Soil Test Input: Goal: Personalize/Inform. Method: HTML form inputs, HTML text output, Chart.js bar chart update. Interaction: User input, button click to generate recommendations and update chart. Justification: Allows users to tailor advice to their specific soil data and see its visual representation.
        - Tools/Products: Goal: Organize. Method: Filterable HTML grid. Interaction: Click buttons to filter. Justification: Helps users quickly find specific items they need.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8FAFC; /* Lighter slate-50 */
            color: #4A5568; /* Darker gray for text */
        }
        .tab-active {
            border-color: #059669; /* Emerald-600 */
            color: #059669; /* Emerald-600 */
            font-weight: 600;
        }
        .tab-inactive {
            border-color: transparent;
            color: #718096; /* Gray-500 */
        }
        .task-card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Default subtle shadow */
        }
        .task-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Enhanced shadow on hover */
        }
        .details-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .details-panel.open {
            max-height: 1000px;
            transition: max-height 0.7s ease-in;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-emerald-600">Lawn Restoration Plan</h1>
                    <p class="text-sm text-gray-500">Arlington Heights, IL</p>
                </div>
                <nav class="hidden md:flex space-x-6">
                    <a href="#conditions" class="text-gray-600 hover:text-emerald-600 transition">Local Conditions</a>
                    <a href="#today-focus" class="text-gray-600 hover:text-emerald-600 transition">Today's Focus</a>
                    <a href="#weather-section" class="text-gray-600 hover:text-emerald-600 transition">Weather & Water</a>
                    <a href="#plan" class="text-gray-600 hover:text-emerald-600 transition">The Plan</a>
                    <a href="#past-tasks" class="text-gray-600 hover:text-emerald-600 transition">Past Tasks</a>
                    <a href="#soil-test-input" class="text-gray-600 hover:text-emerald-600 transition">Soil Test</a>
                    <a href="#tools" class="text-gray-600 hover:text-emerald-600 transition">Tools & Products</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="intro" class="text-center mb-12 md:mb-16">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">Your Path to a Robust Lawn</h2>
            <p class="max-w-3xl mx-auto text-gray-600">This interactive guide translates a detailed restoration report into an actionable, step-by-step plan. It's tailored to the specific climate and soil of Arlington Heights, starting in late July. Navigate through the sections to understand your environment, follow the timeline, and find the right products for a lush, healthy lawn.</p>
            <p id="user-id-display" class="text-xs text-gray-400 mt-4"></p>
        </section>

        <section id="today-focus" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Today's Focus</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">Here are the tasks scheduled for today. Check them off as you complete them to track your progress!</p>
                <div id="today-tasks-list" class="space-y-4">
                </div>
            </div>
        </section>

        <section id="weather-section" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Today's Weather & Watering Advice</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">Get real-time weather information for Arlington Heights and personalized watering recommendations for your lawn. (Weather data is simulated)</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                    <div class="text-center p-4 border border-gray-200 rounded-xl bg-gray-50">
                        <h4 class="font-semibold text-xl text-gray-800 mb-2">Current Conditions</h4>
                        <p class="text-4xl font-bold text-orange-500" id="current-temp">--°F</p>
                        <p class="text-lg text-gray-700" id="feels-like">Feels like --°F</p>
                        <p class="text-md text-gray-600" id="weather-condition">--</p>
                        <p class="text-sm text-gray-500" id="precip-chance">Precip. Chance: --%</p>
                        <p class="text-sm text-gray-500" id="humidity">Humidity: --%</p>
                    </div>
                    <div class="text-center p-4 border border-gray-200 rounded-xl bg-emerald-50">
                        <h4 class="font-semibold text-xl text-gray-800 mb-2">Watering Recommendation</h4>
                        <p id="watering-advice" class="text-lg text-gray-700 leading-relaxed">Checking weather...</p>
                        <p class="text-sm text-gray-500 mt-2">Remember: Your silty soil retains moisture well. Always check soil moisture before watering.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="conditions" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Understanding Your Local Environment</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <p class="text-gray-600 mb-8 text-center max-w-2xl mx-auto">Success starts with knowing your specific conditions. Arlington Heights has a distinct climate and soil profile that dictates the best approach to lawn care. Below are key data points that inform this entire restoration plan.</p>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 p-4 rounded-xl border border-gray-200 bg-gray-50">
                        <h4 class="font-semibold text-lg text-center mb-2">Typical Soil Composition</h4>
                        <div class="chart-container">
                            <canvas id="soilCompositionChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:col-span-1 p-4 rounded-xl border border-gray-200 bg-gray-50">
                        <h4 class="font-semibold text-lg text-center mb-2">Average Monthly Temperatures (°F)</h4>
                         <div class="chart-container">
                            <canvas id="tempChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:col-span-1 p-4 rounded-xl border border-gray-200 bg-gray-50">
                        <h4 class="font-semibold text-lg text-center mb-2">Key Soil Nutrient Levels</h4>
                        <div class="chart-container">
                            <canvas id="nutrientChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="soil-test-input" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Enter Your Soil Test Results</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg max-w-2xl mx-auto">
                <p class="text-gray-600 mb-6 text-center">Input your actual soil test values to get customized nutrient recommendations and insights.</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label for="ph-input" class="block text-sm font-medium text-gray-700">Soil pH</label>
                        <input type="number" id="ph-input" step="0.1" min="4" max="9" value="7.2" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-emerald-600 focus:ring-emerald-600 sm:text-sm p-2">
                    </div>
                    <div>
                        <label for="phosphorus-input" class="block text-sm font-medium text-gray-700">Phosphorus (ppm)</label>
                        <input type="number" id="phosphorus-input" step="0.1" min="0" value="35.5" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-emerald-600 focus:ring-emerald-600 sm:text-sm p-2">
                    </div>
                    <div>
                        <label for="potassium-input" class="block text-sm font-medium text-gray-700">Potassium (ppm)</label>
                        <input type="number" id="potassium-input" step="0.1" min="0" value="215.5" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-emerald-600 focus:ring-emerald-600 sm:text-sm p-2">
                    </div>
                    <div>
                        <label for="calcium-input" class="block text-sm font-medium text-gray-700">Calcium (ppm)</label>
                        <input type="number" id="calcium-input" step="0.1" min="0" value="2894.0" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-emerald-600 focus:ring-emerald-600 sm:text-sm p-2">
                    </div>
                    <div class="sm:col-span-2">
                        <label for="iron-input" class="block text-sm font-medium text-gray-700">Iron (ppm)</label>
                        <input type="number" id="iron-input" step="0.1" min="0" value="150.5" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-emerald-600 focus:ring-emerald-600 sm:text-sm p-2">
                    </div>
                </div>
                <button id="get-soil-recommendations-btn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg font-semibold transition">Get Recommendations</button>
                <div id="soil-recommendations-output" class="mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-lg text-gray-700 hidden">
                </div>
            </div>
        </section>

        <section id="plan" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">The Restoration Plan: A Seasonal Timeline</h3>
            <div class="w-full max-w-4xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <div class="border-b border-gray-200 mb-6">
                    <nav class="-mb-px flex justify-center space-x-4 md:space-x-8" aria-label="Tabs">
                        <button id="tab-phase1" class="phase-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm md:text-base">Phase 1: Prep (Late July - Early Aug)</button>
                        <button id="tab-phase2" class="phase-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm md:text-base">Phase 2: Restore (Mid-Aug - Sept)</button>
                        <button id="tab-phase3" class="phase-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm md:text-base">Phase 3: Maintain (Ongoing)</button>
                    </nav>
                </div>

                <div id="content-phase1" class="phase-content mt-8">
                    <div class="space-y-6">
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-1">
                                <span class="text-lg font-semibold text-gray-800">1. Comprehensive Soil Testing</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-1" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-4">This is the cornerstone of the plan. A lab test provides precise data on pH and nutrient levels, removing guesswork. Collect 10-15 random samples from a 3-6 inch depth, mix them, and send to a certified lab. This data-driven approach ensures all treatments are tailored to your lawn's exact needs.</p>
                                <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-lg text-sm text-gray-700">
                                    <strong class="font-semibold">Why it's critical:</strong> Soil pH affects nutrient availability. Without a test, you might apply fertilizers your lawn can't even use, wasting time and money.
                                </div>
                            </div>
                        </div>
                         <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-2">
                                <span class="text-lg font-semibold text-gray-800">2. Weed & Pest Identification</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-2" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-4">Identify existing weeds (dandelion, clover, crabgrass) and pests (grubs). In late July's heat, control should be cautious. Hand-pulling is effective for small areas. If using herbicides, spot-treat only and avoid application on days over 85°F. The main chemical attack is best saved for the cooler fall.</p>
                                <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-lg text-sm text-gray-700">
                                    <strong class="font-semibold">Key Strategy:</strong> The goal now is containment, not eradication. Aggressive chemical use in summer heat can stress your grass more than the weeds.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="content-phase2" class="phase-content mt-8 hidden">
                    <div class="space-y-6">
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-3">
                                <span class="text-lg font-semibold text-gray-800">1. Aeration & Dethatching</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-3" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-4">This is the most important window for restoration. In late August/September, use a core aerator to reduce soil compaction. This allows oxygen, water, and nutrients to reach the roots. If thatch (dead grass layer) is over 0.5 inches thick, use a dethatcher. Perform when soil is moist but not wet.</p>
                                <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-lg text-sm text-gray-700">
                                    <strong class="font-semibold">Pro Tip:</strong> Aerating before overseeding creates perfect pockets for seeds to germinate, dramatically increasing success rates.
                                </div>
                            </div>
                        </div>
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-4">
                                <span class="text-lg font-semibold text-gray-800">2. Overseeding with a Quality Blend</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-4" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-4">Immediately after aeration, spread a high-quality cool-season grass seed blend. A mix of Kentucky Bluegrass, Perennial Ryegrass, and Fescue is ideal for northern Illinois. This blend provides quick cover, dense growth, and shade/drought tolerance. Cover lightly with peat moss or straw and water daily until germination (10-14 days).</p>
                                <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-lg text-sm text-gray-700">
                                    <strong class="font-semibold">The Ideal Blend:</strong> <br>
                                    - <strong class="text-gray-700">Kentucky Bluegrass:</strong> For density & self-repair. <br>
                                    - <strong class="text-gray-700">Perennial Ryegrass:</strong> For quick germination. <br>
                                    - <strong class="text-gray-700">Fescue (Tall/Fine):</strong> For drought & shade tolerance.
                                </div>
                            </div>
                        </div>
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-5">
                                <span class="text-lg font-semibold text-gray-800">3. Apply Starter Fertilizer</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-5" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-4">At the time of seeding, apply a starter fertilizer. These formulas are high in phosphorus (the 'P' in N-P-K), the key nutrient for strong root development. This gives your new seedlings the best possible start to establish a robust root system before winter.</p>
                                <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-lg text-sm text-gray-700">
                                    <strong class="font-semibold">Look for NPK Ratios like:</strong> 10-18-10 or 18-24-12. The middle number (Phosphorus) should be the highest.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="content-phase3" class="phase-content mt-8 hidden">
                    <div class="space-y-6">
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-6">
                                <span class="text-lg font-semibold text-gray-800">Mowing & Watering Strategy</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-6" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-2"><strong class="font-semibold">Mowing:</strong> Mow high, at 3 to 3.5 inches. Never remove more than one-third of the blade at a time (the "one-third rule"). Taller grass shades out weeds and develops deeper roots. Keep blades sharp!</p>
                                <p class="text-gray-600"><strong class="font-semibold">Watering:</strong> Water deeply but infrequently (1 to 1.5 inches per week). This encourages deep root growth. Water in the early morning to reduce evaporation. Remember your silty soil retains moisture well, so check for dryness before watering.</p>
                            </div>
                        </div>
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-7">
                                <span class="text-lg font-semibold text-gray-800">Annual Fertilization Schedule</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-7" class="details-panel px-5 pb-5">
                                <ul class="list-disc list-inside text-gray-600 space-y-2">
                                    <li><strong class="font-semibold">Early Spring (Feb-Apr):</strong> Apply a slow-release fertilizer as the lawn greens up.</li>
                                    <li><strong class="font-semibold">Late Spring (Apr-Jun):</strong> Second feeding 6-8 weeks after the first.</li>
                                    <li><strong class="font-semibold">Summer (Jun-Jul):</strong> Use a summer-specific formula if needed, and only with adequate water.</li>
                                    <li><strong class="font-semibold text-emerald-600">Fall (Sept & Nov):</strong> The most important feedings! Use a "Winterizer" fertilizer to build strong roots and ensure a quick green-up next spring.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="task-card bg-gray-50 rounded-xl shadow-sm overflow-hidden">
                            <button class="w-full text-left p-5 flex justify-between items-center focus:outline-none" data-target="details-8">
                                <span class="text-lg font-semibold text-gray-800">Integrated Pest & Weed Management</span>
                                <span class="text-2xl text-emerald-600 transition-transform duration-300">&#9662;</span>
                            </button>
                            <div id="details-8" class="details-panel px-5 pb-5">
                                <p class="text-gray-600 mb-2"><strong class="font-semibold">Proactive (Pre-emergent):</strong> Apply in late April/early May to prevent crabgrass. Note: this will also prevent grass seed from growing.</p>
                                <p class="text-gray-600"><strong class="font-semibold">Reactive (Post-emergent):</strong> Spot-treat existing broadleaf weeds in the fall. This is when herbicides are most effective as weeds are storing energy in their roots. Monitor for grubs in late summer and treat if necessary.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="past-tasks" class="mb-12 md:mb-16 scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Past Tasks Completed</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">Review your completed tasks and see the progress you've made towards a healthier lawn!</p>
                <div id="completed-tasks-list" class="space-y-4">
                </div>
            </div>
        </section>

        <section id="tools" class="scroll-mt-20">
            <h3 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8">Tools & Products Checklist</h3>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <div class="flex flex-wrap justify-center gap-2 mb-8">
                    <button class="filter-btn bg-emerald-600 text-white py-2 px-4 rounded-full text-sm font-semibold transition hover:bg-emerald-700">All</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 py-2 px-4 rounded-full text-sm font-semibold transition hover:bg-gray-300" data-filter="tool">Tools</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 py-2 px-4 rounded-full text-sm font-semibold transition hover:bg-gray-300" data-filter="seed">Seed</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 py-2 px-4 rounded-full text-sm font-semibold transition hover:bg-gray-300" data-filter="fertilizer">Fertilizers</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 py-2 px-4 rounded-full text-sm font-semibold transition hover:bg-gray-300" data-filter="control">Weed/Pest Control</button>
                </div>
                <div id="product-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    </div>
            </div>
        </section>

    </main>

    <footer class="bg-white mt-16">
        <div class="container mx-auto px-8 py-6 text-center text-gray-500">
            <p>&copy; 2024 Interactive Lawn Plan. Information sourced from the Comprehensive Lawn Restoration Report.</p>
        </div>
    </footer>

    <script>
        function getCategoryColor(category) {
            switch (category) {
                case 'tool': return 'bg-blue-100 text-blue-800';
                case 'seed': return 'bg-yellow-100 text-yellow-800';
                case 'fertilizer': return 'bg-green-100 text-green-800';
                case 'control': return 'bg-red-100 text-red-800';
                case 'Prep': return 'bg-purple-100 text-purple-800';
                case 'Restore': return 'bg-orange-100 text-orange-800';
                case 'Maintain': return 'bg-teal-100 text-teal-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const productData = [
                { name: 'Lab-based Soil Test Kit', category: 'tool', desc: 'For accurate pH and nutrient analysis.' },
                { name: 'Broadcast/Drop Spreader', category: 'tool', desc: 'For even application of seed and fertilizer.' },
                { name: 'Core Aerator', category: 'tool', desc: 'Rentable tool to reduce soil compaction.' },
                { name: 'Dethatcher', category: 'tool', desc: 'Rentable tool to remove excess thatch.' },
                { name: 'Lawn Mower (Sharp Blades)', category: 'tool', desc: 'Essential for proper mowing practices.' },
                { name: 'Garden Rake', category: 'tool', desc: 'For preparing seedbeds.' },
                { name: 'Cool-Season Grass Blend', category: 'seed', desc: 'Mix of Kentucky Bluegrass, Ryegrass, and Fescue.' },
                { name: 'Starter Fertilizer', category: 'fertilizer', desc: 'High-phosphorus formula for new seeds (e.g., 10-18-10).' },
                { name: 'Fall/Winterizer Fertilizer', category: 'fertilizer', desc: 'High-potassium formula for winter hardiness (e.g., 32-0-10).' },
                { name: 'Spring/Summer Fertilizer', category: 'fertilizer', desc: 'Slow-release formulas for seasonal growth.' },
                { name: 'Post-Emergent Broadleaf Herbicide', category: 'control', desc: 'For existing broadleaf weeds (e.g., contains 2,4-D, MCPP).' },
                { name: 'Pre-Emergent Herbicide', category: 'control', desc: 'For preventing crabgrass in spring.' },
                { name: 'Grub Control Product', category: 'control', desc: 'Immediate (Dylox) or long-term (Nematodes) options.' },
                { name: 'Peat Moss / Straw', category: 'seed', desc: 'Light covering to protect new seeds.' },
            ];

            const productGrid = document.getElementById('product-grid');
            const filterBtns = document.querySelectorAll('.filter-btn');

            function renderProducts(filter) {
                productGrid.innerHTML = '';
                const filteredProducts = filter === 'all' ? productData : productData.filter(p => p.category === filter);
                
                filteredProducts.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card border rounded-xl p-4 flex flex-col justify-between bg-gray-50';
                    card.innerHTML = `
                        <div>
                            <p class="font-semibold text-gray-800">${product.name}</p>
                            <p class="text-sm text-gray-600">${product.desc}</p>
                        </div>
                        <span class="text-xs font-medium uppercase mt-3 px-2 py-1 rounded-full self-start ${getCategoryColor(product.category)}">${product.category}</span>
                    `;
                    productGrid.appendChild(card);
                });
            }

            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => {
                        b.classList.remove('bg-emerald-600', 'text-white');
                        b.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    btn.classList.add('bg-emerald-600', 'text-white');
                    btn.classList.remove('bg-gray-200', 'text-gray-700');
                    renderProducts(btn.dataset.filter);
                });
            });

            renderProducts('all');
            
            const phaseTabs = document.querySelectorAll('.phase-tab');
            const phaseContents = document.querySelectorAll('.phase-content');

            phaseTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    phaseTabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });
                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');
                    
                    const targetId = 'content-' + tab.id.split('-')[1];
                    phaseContents.forEach(content => {
                        if (content.id === targetId) {
                            content.classList.remove('hidden');
                        } else {
                            content.classList.add('hidden');
                        }
                    });
                });
            });

            document.getElementById('tab-phase1').classList.add('tab-active');
            document.getElementById('tab-phase1').classList.remove('tab-inactive');

            const accordionButtons = document.querySelectorAll('.task-card button');
            accordionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const detailsPanel = document.getElementById(button.dataset.target);
                    const arrow = button.querySelector('span:last-child');
                    
                    if (detailsPanel.classList.contains('open')) {
                        detailsPanel.classList.remove('open');
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        document.querySelectorAll('.details-panel.open').forEach(openPanel => {
                            openPanel.classList.remove('open');
                            openPanel.previousElementSibling.querySelector('span:last-child').style.transform = 'rotate(0deg)';
                        });
                        detailsPanel.classList.add('open');
                        arrow.style.transform = 'rotate(180deg)';
                    }
                });
            });

            initializeCharts();
            displayWeatherAndWatering();
            setupSoilTestInput();

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        });

        function initializeCharts() {
            const soilCtx = document.getElementById('soilCompositionChart').getContext('2d');
            new Chart(soilCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Silt', 'Clay', 'Sand'],
                    datasets: [{
                        label: 'Soil Composition',
                        data: [63, 23, 14],
                        backgroundColor: ['#A89C94', '#6F6259', '#D4C4B8'], /* Earthy tones for soil */
                        borderColor: '#F8FAFC', /* Match body background */
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { callbacks: { label: (context) => `${context.label}: ${context.raw}%` } }
                    }
                }
            });

            const tempCtx = document.getElementById('tempChart').getContext('2d');
            new Chart(tempCtx, {
                type: 'line',
                data: {
                    labels: ['May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                    datasets: [{
                        label: 'Avg High Temp',
                        data: [74, 81, 84, 82, 75, 63],
                        borderColor: '#F97316', /* Orange-500 */
                        backgroundColor: 'rgba(249, 115, 22, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Avg Low Temp',
                        data: [52, 61, 65, 63, 55, 44],
                        borderColor: '#3B82F6', /* Blue-500 */
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } },
                    scales: { y: { beginAtZero: false, ticks: { callback: (value) => `${value}°F` } } }
                }
            });

            const nutrientCtx = document.getElementById('nutrientChart').getContext('2d');
            nutrientChartInstance = new Chart(nutrientCtx, {
                type: 'bar',
                data: {
                    labels: ['Phosphorus', 'Potassium', 'Calcium', 'Iron'],
                    datasets: [{
                        label: 'Nutrient Level (ppm)',
                        data: [35.5, 215.5, 2894.0, 150.5],
                        backgroundColor: ['#059669', '#10B981', '#34D399', '#6EE7B7'], /* Emerald shades */
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            type: 'logarithmic',
                            ticks: {
                                callback: function(value, index, values) {
                                    if (value === 10 || value === 100 || value === 1000 || value === 3000) {
                                        return value.toString();
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        async function displayWeatherAndWatering() {
            const mockWeather = {
                current_conditions: {
                    temperature: "87°F",
                    feels_like_temperature: "96°F",
                    current_weather_conditions: "partly cloudy",
                    precipitation: { chance: "0%" },
                    humidity: "63%"
                },
                daily_forecasts: [
                    {
                        forecast_day: `Sunday, July 27, 2025 (today)`,
                        high_temperature: "88°F",
                        day_time_precipitation: { chance: "45%" }
                    }
                ]
            };

            document.getElementById('current-temp').textContent = mockWeather.current_conditions.temperature;
            document.getElementById('feels-like').textContent = `Feels like ${mockWeather.current_conditions.feels_like_temperature}`;
            document.getElementById('weather-condition').textContent = mockWeather.current_conditions.current_weather_conditions;
            document.getElementById('precip-chance').textContent = `Precip. Chance: ${mockWeather.daily_forecasts[0].day_time_precipitation.chance}`;
            document.getElementById('humidity').textContent = `Humidity: ${mockWeather.current_conditions.humidity}`;

            const currentTemp = parseFloat(mockWeather.current_conditions.temperature.replace('°F', ''));
            const precipChance = parseFloat(mockWeather.daily_forecasts[0].day_time_precipitation.chance.replace('%', ''));
            
            document.getElementById('watering-advice').textContent = getWateringRecommendation(currentTemp, precipChance);
        }

        function getWateringRecommendation(currentTemp, precipChance) {
            if (precipChance >= 40) {
                return "Rain is expected today! Defer watering your lawn. Check soil moisture after rainfall, as silty soil retains moisture well.";
            } else if (currentTemp >= 85) {
                return "It's hot today! Your lawn is under stress. Consider watering deeply if the soil feels dry, but always check moisture levels. Silty soil retains moisture, so avoid overwatering.";
            } else {
                return "No specific concerns. Water deeply (1 to 1.5 inches per week) but infrequently, in the early morning. Let the topsoil dry slightly between waterings.";
            }
        }

        function setupSoilTestInput() {
            const phInput = document.getElementById('ph-input');
            const phosphorusInput = document.getElementById('phosphorus-input');
            const potassiumInput = document.getElementById('potassium-input');
            const calciumInput = document.getElementById('calcium-input');
            const ironInput = document.getElementById('iron-input');
            const getRecommendationsBtn = document.getElementById('get-soil-recommendations-btn');
            const recommendationsOutput = document.getElementById('soil-recommendations-output');

            getRecommendationsBtn.addEventListener('click', () => {
                const ph = parseFloat(phInput.value);
                const phosphorus = parseFloat(phosphorusInput.value);
                const potassium = parseFloat(potassiumInput.value);
                const calcium = parseFloat(calciumInput.value);
                const iron = parseFloat(ironInput.value);

                const recommendations = generateSoilRecommendations(ph, phosphorus, potassium, calcium, iron);
                recommendationsOutput.innerHTML = recommendations.join('<br>');
                recommendationsOutput.classList.remove('hidden');

                if (nutrientChartInstance) {
                    nutrientChartInstance.data.datasets[0].data = [phosphorus, potassium, calcium, iron];
                    nutrientChartInstance.update();
                }
            });
        }

        function generateSoilRecommendations(ph, p, k, ca, fe) {
            const recs = [];

            recs.push('<strong>Soil Test Recommendations:</strong>');

            if (ph > 7.5) {
                recs.push(`Your soil pH (${ph}) is high. This can reduce the availability of some nutrients like nitrogen and iron. Significant pH reduction in high-carbonate soils is difficult; focus on proper fertilization and cultural practices.`);
            } else if (ph < 6.0) {
                recs.push(`Your soil pH (${ph}) is low. Consider applying lime to slowly raise the pH. Consult a local expert for application rates.`);
            } else {
                recs.push(`Your soil pH (${ph}) is within the optimal range for cool-season grasses. Focus on balanced fertilization.`);
            }

            if (p < 20) {
                recs.push(`Your Phosphorus (${p} ppm) is low. Apply a starter fertilizer (high in phosphorus, e.g., 10-18-10) or a specific phosphorus supplement to promote root growth.`);
            } else if (p > 50) {
                recs.push(`Your Phosphorus (${p} ppm) is high. Avoid phosphorus-rich fertilizers to prevent environmental runoff and imbalances.`);
            } else {
                recs.push(`Your Phosphorus (${p} ppm) is at a healthy level. Continue with balanced fertilization.`);
            }

            if (k < 120) {
                recs.push(`Your Potassium (${k} ppm) is low. Apply a balanced fertilizer or a high-potassium "winterizer" fertilizer to improve stress resistance.`);
            } else if (k > 250) {
                 recs.push(`Your Potassium (${k} ppm) is quite high. Monitor levels but generally, no extra potassium is needed.`);
            } else {
                recs.push(`Your Potassium (${k} ppm) is at a healthy level. Continue with balanced fertilization.`);
            }

            if (ca < 1000) {
                recs.push(`Your Calcium (${ca} ppm) is low. Consider adding a calcium source like gypsum, especially if soil structure or drainage is an issue.`);
            } else {
                recs.push(`Your Calcium (${ca} ppm) is at a healthy level.`);
            }

            if (fe < 50) {
                recs.push(`Your Iron (${fe} ppm) is low. Consider an iron supplement to enhance greening, especially if pH is high as this can affect iron availability.`);
            } else {
                recs.push(`Your Iron (${fe} ppm) is at a healthy level. Your lawn should have good color.`);
            }

            return recs;
        }
    </script>
</body>
</html>
